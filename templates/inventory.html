{% load static  %}

<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>WAREFLOW</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     
    
    <!-- FontAwesome JS-->
	<script defer src="{% static 'assets/plugins/fontawesome/js/all.min.js' %}"></script>

    
    <!-- App CSS -->  
    <link id="theme-style" rel="stylesheet" href="{% static 'assets/css/portal.css' %}">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="{% static 'assets/js/jspdf.umd.min.js' %}"></script>
<!-- Add these to your HTML to include Bootstrap and jQuery -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


	<style>
        /* Add your CSS styling here */
        /* This is just a basic example */
        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
			z-index: 9999;
			overflow-y: scroll;
			max-height: 800px;
        }

		/* Custom dropdown styles */
		.custom-dropdown {
			position: relative;
			display: inline-block;
		}

		/* Dropdown menu styles */
		.dropdown-menu {
			max-height: 200px; /* Adjust as needed */
			overflow-y: auto;
			width: 100%;
		}

		/* Custom checkbox styles */
		.custom-control-label::before {
			width: 1.25rem;
			height: 1.25rem;
		}

		/* Adjust other styles as needed */
		  /* CSS styles for the table */
		.product-details-table {
			width: 100%;
			border-collapse: collapse;
		}

		/* CSS styles for table rows */
		.product-details-row {
			border: 1px solid #ddd;
		}

		/* CSS styles for table cells */
		.product-details-key {
			font-weight: bold;
			padding: 10px;
			text-align: right;
			background-color: #f0f0f0;
		}

		.product-details-value {
			padding: 10px;
		}


    </style>

</head> 

<body class="app">   	
    <header class="app-header fixed-top">	   	            
        <div class="app-header-inner">  
	        <div class="container-fluid py-2">
		        <div class="app-header-content"> 
		            <div class="row justify-content-between align-items-center">
			        
				    <div class="col-auto">
					    <a id="sidepanel-toggler" class="sidepanel-toggler d-inline-block d-xl-none" href="#">
						    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg>
					    </a>
				    </div><!--//col-->		            
		            <div class="app-utilities col-auto ml-auto">
			            {% comment %} <div class="app-utility-item app-notifications-dropdown dropdown">    
				            <a class="dropdown-toggle no-toggle-arrow" id="notifications-dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false" title="Notifications">
					            <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bell icon" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2z"/>
  <path fill-rule="evenodd" d="M8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z"/>
</svg>
					            <span class="icon-badge">3</span>
					        </a><!--//dropdown-toggle-->
					        
					        <div class="dropdown-menu p-0" aria-labelledby="notifications-dropdown-toggle">
					            <div class="dropdown-menu-header p-3">
						            <h5 class="dropdown-menu-title mb-0">Notifications</h5>
						        </div><!--//dropdown-menu-title-->
						        <div class="dropdown-menu-content">
							       <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										       <img class="profile-image" src="{% static 'assets/images/profiles/profile-1.png' %}" alt="">
									        </div><!--//col-->
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">Amy shared a file with you. Lorem ipsum dolor sit amet, consectetur adipiscing elit. </div>
											        <div class="meta"> 2 hrs ago</div>
										        </div>
									        </div><!--//col--> 
								        </div><!--//row-->
								        <a class="link-mask" href={% url 'notifications' %}></a>
							       </div><!--//item-->
							       <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										        <div class="app-icon-holder">
											        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-receipt" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
	  <path fill-rule="evenodd" d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z"/>
	  <path fill-rule="evenodd" d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z"/>
	</svg>
										        </div>
									        </div><!--//col-->
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">You have a new invoice. Proin venenatis interdum est.</div>
											        <div class="meta"> 1 day ago</div>
										        </div>
									        </div><!--//col-->
								        </div><!--//row-->
								        <a class="link-mask" href={% url 'notifications' %}></a>
							       </div><!--//item-->
							       <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										        <div class="app-icon-holder icon-holder-mono">
											        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bar-chart-line" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
</svg>
										        </div>
									        </div><!--//col-->
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">Your report is ready. Proin venenatis interdum est.</div>
											        <div class="meta"> 3 days ago</div>
										        </div>
									        </div><!--//col-->
								        </div><!--//row-->
								        <a class="link-mask" href={% url 'notifications' %}></a>
							       </div><!--//item-->
							       <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										       <img class="profile-image" src="{% static 'assets/images/profiles/profile-2.png' %}" alt="">
									        </div><!--//col-->
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">James sent you a new message.</div>
											        <div class="meta"> 7 days ago</div>
										        </div>
									        </div><!--//col--> 
								        </div><!--//row-->
								        <a class="link-mask" href={% url 'notifications' %}></a>
							       </div><!--//item-->
						        </div><!--//dropdown-menu-content-->
						        
						        <div class="dropdown-menu-footer p-2 text-center">
							        <a href={% url 'notifications' %}>View all</a>
						        </div>
															
							</div><!--//dropdown-menu-->					        
				        </div><!--//app-utility-item--> {% endcomment %}
			            
			            <div class="app-utility-item app-user-dropdown dropdown">
							<a class="dropdown-toggle" id="user-dropdown-toggle"
								data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
								<img src="{% if request.session.profile_picture_url %}{{ request.session.profile_picture_url }}{% else %}{% static 'assets/images/user.png' %}{% endif %}" alt="user profile">
							</a>
							<ul class="dropdown-menu" aria-labelledby="user-dropdown-toggle">
								<li><span class="dropdown-item">{{ request.session.name }}</span></li>
								<li><a class="dropdown-item" href={% url 'profile_view' %}>Account</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href={% url 'loggout' %}>Log Out</a></li>
							</ul>
						</div><!--//app-user-dropdown-->
		            </div><!--//app-utilities-->
		        </div><!--//row-->
	            </div><!--//app-header-content-->
	        </div><!--//container-fluid-->
        </div><!--//app-header-inner-->
        <div id="app-sidepanel" class="app-sidepanel sidepanel-hidden"> 
	        <div id="sidepanel-drop" class="sidepanel-drop"></div>
	        <div class="sidepanel-inner d-flex flex-column">
		        <a href="#" id="sidepanel-close" class="sidepanel-close d-xl-none">&times;</a>
		        <div class="app-branding">
		            <a class="app-logo" href={% url 'index' %}><img class="logo-icon me-2" src="{% static 'assets/images/app-logo.svg' %}" alt="logo"><span class="logo-text">WAREFLOW</span></a>
	
		        </div><!--//app-branding-->  
			    <nav id="app-nav-main" class="app-nav app-nav-main flex-grow-1">
				    <ul class="app-menu list-unstyled accordion" id="menu-accordion">
					    <li class="nav-item">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link" href={% url 'index' %}>
						        <span class="nav-icon">
						        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-house-door" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
		  <path fill-rule="evenodd" d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z"/>
		  <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
		</svg>
						         </span>
		                         <span class="nav-link-text">Dashboard</span>
					        </a><!--//nav-link-->
					    </li><!--//nav-item-->
						<li class="nav-item">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link active" href={% url 'list_products' %}>
									<span class="nav-icon svg-icon svg-icon-primary svg-icon-2x"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-05-14-112058/theme/html/demo8/dist/../src/media/svg/icons/Shopping/Cart1.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24"/>
											<path d="M18.1446364,11.84388 L17.4471627,16.0287218 C17.4463569,16.0335568 17.4455155,16.0383857 17.4446387,16.0432083 C17.345843,16.5865846 16.8252597,16.9469884 16.2818833,16.8481927 L4.91303792,14.7811299 C4.53842737,14.7130189 4.23500006,14.4380834 4.13039941,14.0719812 L2.30560137,7.68518803 C2.28007524,7.59584656 2.26712532,7.50338343 2.26712532,7.4104669 C2.26712532,6.85818215 2.71484057,6.4104669 3.26712532,6.4104669 L16.9929851,6.4104669 L17.606173,3.78251876 C17.7307772,3.24850086 18.2068633,2.87071314 18.7552257,2.87071314 L20.8200821,2.87071314 C21.4717328,2.87071314 22,3.39898039 22,4.05063106 C22,4.70228173 21.4717328,5.23054898 20.8200821,5.23054898 L19.6915238,5.23054898 L18.1446364,11.84388 Z" fill="#000000" opacity="0.3"/>
											<path d="M6.5,21 C5.67157288,21 5,20.3284271 5,19.5 C5,18.6715729 5.67157288,18 6.5,18 C7.32842712,18 8,18.6715729 8,19.5 C8,20.3284271 7.32842712,21 6.5,21 Z M15.5,21 C14.6715729,21 14,20.3284271 14,19.5 C14,18.6715729 14.6715729,18 15.5,18 C16.3284271,18 17,18.6715729 17,19.5 C17,20.3284271 16.3284271,21 15.5,21 Z" fill="#000000"/>
										</g>
									</svg><!--end::Svg Icon--></span>
		                         <span class="nav-link-text">Inventory</span>
					        </a><!--//nav-link-->
					    </li><!--//nav-item-->
					    <li class="nav-item">
							<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
							<a class="nav-link" href={% url 'charts' %}>
								<span class="nav-icon">
									<svg width="1em" height="1em" viewBox="0 0 16 16"
										class="bi bi-bar-chart-line" fill="currentColor"
										xmlns="http://www.w3.org/2000/svg">
										<path fill-rule="evenodd"
											d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z" />
									</svg>
								</span>
								<span class="nav-link-text">Charts</span>
							</a><!--//nav-link-->
						</li><!--//nav-item-->
					   
					    <li class="nav-item">
							<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
							<a class="nav-link" href={% url 'list_suppliers' %}>
								<span class="nav-icon">
									<svg style="color: rgb(75, 74, 73);" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16"> <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" fill="#4b4a49"></path> <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z" fill="#4b4a49"></path> </svg>
								</span>
								<span class="nav-link-text">Suppliers</span>
							</a><!--//nav-link-->
						</li><!--//nav-item-->
						<li class="nav-item">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link" href={% url 'list_orders' %}>
						        <span class="nav-icon">
									<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M9.99998 15L9.99999 19C10 20.1046 9.10457 21 7.99999 21H4C2.89543 21 2 20.1046 2 19V15C2 13.8954 2.89543 13 4 13H7.99998C9.10455 13 9.99998 13.8954 9.99998 15Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> <path d="M16 4.99999L16 8.99999C16 10.1046 15.1046 11 14 11H10C8.89543 11 8 10.1046 8 9V5C8 3.89543 8.89543 3 10 3H14C15.1045 3 16 3.89543 16 4.99999Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> <path d="M22 15L22 19C22 20.1046 21.1046 21 20 21H16C14.8954 21 14 20.1046 14 19V15C14 13.8954 14.8954 13 16 13H20C21.1045 13 22 13.8954 22 15Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> <path d="M6 16V13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> <path d="M12 6V3" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> <path d="M18 16V13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/> </svg>
						         </span>
		                         <span class="nav-link-text">Orders</span>
					        </a><!--//nav-link-->
					    </li><!--//nav-item-->
					    
					    <li class="nav-item">
							<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
							<a class="nav-link" href={% url 'list_storage' %}>
								<span class="nav-icon">
									<svg width="1em" height="1em" viewBox="0 0 16 16"
										class="bi bi-question-circle" fill="currentColor"
										xmlns="http://www.w3.org/2000/svg">
										<path fill-rule="evenodd"
											d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
										<path
											d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z" />
									</svg>
								</span>
								<span class="nav-link-text">Storage Locations</span>
							</a><!--//nav-link-->
						</li><!--//nav-item-->
				    </ul><!--//app-menu-->
			    </nav><!--//app-nav-->
			    <div class="app-sidepanel-footer">
				    <nav class="app-nav app-nav-footer">
					    <ul class="app-menu footer-menu list-unstyled">
							<li class="nav-item">
								<a class="nav-link" href={% url 'loggout' %}>
									<span class="nav-icon">
										<svg style="color: rgb(93, 94, 101);" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" fill="#5d5e65"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>										</span>
									<span class="nav-link-text">Logout</span>
								</a>
							</li><!--//nav-item-->
					    </ul><!--//footer-menu-->
				    </nav>
			    </div><!--//app-sidepanel-footer-->
	        </div><!--//sidepanel-inner-->
	    </div><!--//app-sidepanel-->
    </header><!--//app-header-->
    
    <div class="app-wrapper">
	    
	    <div class="app-content pt-3 p-md-3 p-lg-4">
		    <div class="container-xl">
			    
			    <div class="row g-3 mb-4 align-items-center justify-content-between">
				    <div class="col-auto">
			            <h1 class="app-page-title mb-0">Inventory</h1>
				    </div>
				    <div class="col-auto">
					     <div class="page-utilities">
						    <div class="row g-2 justify-content-start justify-content-md-end align-items-center">
							    <div class="col-auto">
								    <form class="table-search-form row gx-1 align-items-center">
					                    <div class="col-auto">
					                        <input type="text" id="search-orders" name="searchorders" class="form-control search-orders" placeholder="Search">
					                    </div>
					                    <div class="col-auto">
											<select class="form-select w-auto" >
												<option selected value="option-1">All</option>
												<option value="option-2">This week</option>
												<option value="option-3">This month</option>
												<option value="option-4">Last 3 months</option>
												
										  </select>
					                        
					                    </div>
					                </form>
					                
							    </div><!--//col-->
							    <div class="col-auto">
								    <a class="btn btn-info" href="#" id="showFormButton">
										{% comment %} <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-download me-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg"> {% endcomment %}
											<path fill-rule="evenodd" d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
											<path fill-rule="evenodd" d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
										{% comment %} </svg> {% endcomment %}
										ADD PRODUCT
									</a>
								    
							    </div>
							    <div class="col-auto">						    
									<button id="deleteAllButton" class="btn text-white btn-danger" disabled>Delete All</button>
								</div>
								<div class="col-auto">						  
									<a id="generate-pdf-btn" class="btn btn-secondary generate-pdf" href="{% url 'export_pdf' %}">Generate PDF</a>
								</div>
						    </div><!--//row-->
					    </div><!--//table-utilities-->
				    </div><!--//col-auto-->
			    </div><!--//row-->


				<div id="productFormPopup" class="popup">
					<h2 class="mb-4">Add Product</h2>
					<form method="post" enctype="multipart/form-data" id="add-product-form">
						{% csrf_token %}
				
						<input type="hidden" id="product-id" name="product-id" class="form-control">
				
						<!-- Product Image -->
						<div class="form-group">
							<div id="imagePreview" class="mt-3 text-center">
								<img id="previewImage" src="" alt="Image Preview" class="rounded-circle" style="max-width: 150px; max-height: 150px;">
							</div>
							<label for="productImage">Product Image:</label>
							<input type="file" id="productImage" name="productImage" class="form-control-file">
							<span id="productImageError" class="text-danger"></span>
						</div>
				
						<!-- Category -->
						<div class="form-group">
							<label for="category">Category:</label>
							<select id="category" name="category" class="form-control">
								<option value="" disabled selected>Select</option> <!-- Added option for placeholder -->
								{% for Category in categories %}
									<option value="{{ Category.category_id }}">{{ Category.category_name }}</option>
								{% endfor %}
							</select>
							<span id="categoryError" class="text-danger"></span> <!-- Error message for Category -->
						</div>
				
						<!-- Subcategory -->
						<div class="form-group">
							<label for="subcategory">Subcategory:</label>
							<select id="subcategory" name="subcategory" class="form-control">
								<option value="">Select a category first</option>
							</select>
							<span id="subcategoryError" class="text-danger"></span> <!-- Error message for Subcategory -->
						</div>
				
						<!-- Brand -->
						<div class="form-group">
							<label for="brand">Brand:</label>
							<select id="brand" name="brand" class="form-control">
								<option value="" disabled selected>Select</option>
								{% for Brand in brands %}
									<option value="{{ Brand.brand_id }}">{{ Brand.brand_name }}</option>
								{% endfor %}
							</select>
							<span id="brandError" class="text-danger"></span> <!-- Error message for Brand -->
						</div>
				
						<!-- Product Type -->
						<div class="form-group">
							<label for="productType">Product Type:</label>
							<select id="productType" name="productType" class="form-control">
								<option value="" disabled selected>Select</option>
								{% for ProductType in productTypes %}
									<option value="{{ ProductType.product_type_id }}">{{ ProductType.type_name }}</option>
								{% endfor %}
							</select>
							<span id="productTypeError" class="text-danger"></span> <!-- Error message for Product Type -->
						</div>
				
						<!-- Subtype -->
						<div class="form-group">
							<label for="subtype">Subtype:</label>
							<select id="subtype" name="subtype" class="form-control">
								<option value="" disabled selected>Select</option>
								{% for Subtype in subtypes %}
									<option value="{{ Subtype.subtype_id }}">{{ Subtype.subtype_name }}</option>
								{% endfor %}
							</select>
							<span id="subtypeError" class="text-danger"></span> <!-- Error message for Subtype -->
						</div>
				
						<!-- Product Name -->
						<div class="form-group">
							<label for="productName">Product Name:</label>
							<input type="text" id="productName" name="productName" class="form-control">
							<span id="productNameError" class="text-danger"></span> <!-- Error message for Product Name -->
						</div>
				
						<!-- Quantity -->
						<div class="form-group">
							<label for="quantity">Quantity:</label>
							<input type="number" id="quantity" name="quantity" class="form-control">
							<span id="quantityError" class="text-danger"></span> <!-- Error message for Quantity -->
						</div>
				
						<!-- Suppliers -->
						<div class="form-group">
							<label for="suppliers">Suppliers:</label>
							<div class="custom-dropdown" id="supplierDropdown">
								<button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown">
									Select Suppliers
								</button>
								<div class="dropdown-menu" id="supplierDropdownMenu">
									{% for supplier in suppliers %}
										<div class="custom-control custom-checkbox">
											<input type="checkbox" class="custom-control-input" id="supplier_{{ supplier.supplier_id }}"
												name="suppliers[]" value="{{ supplier.supplier_id }}">
											<label class="custom-control-label" for="supplier_{{ supplier.supplier_id }}">
												{{ supplier.supplier_name }}
											</label>
										</div>
									{% endfor %}
								</div>
							</div>
							<span id="suppliersError" class="text-danger"></span>
						</div>
				
						<!-- Threshold Value -->
						<div class="form-group">
							<label for "thresholdValue">Threshold Value:</label>
							<input type="number" id="thresholdValue" name="thresholdValue" class="form-control">
							<span id="thresholdValueError" class="text-danger"></span> <!-- Error message for Threshold Value -->
						</div>
				
						<!-- Buttons -->
						<div class="form-group">
							<input type="submit" value="Add" class="btn btn-primary add-product">
							<button type="button" id="cancelButton" class="btn btn-secondary">Cancel</button>
						</div>
					</form>
				</div>
				
				
				<script>
					// Wrap your code in a document ready function
					$(document).ready(function() {
					  const showFormButton = document.getElementById('showFormButton');
					  const productFormPopup = document.getElementById('productFormPopup');
					  const cancelButton = document.getElementById('cancelButton');
				  
					  showFormButton.addEventListener('click', () => {
						productFormPopup.style.display = 'block';
					  });
				  
					  cancelButton.addEventListener('click', () => {
						productFormPopup.style.display = 'none';
					  });
				  
					  $('#category').on('change', function() {
						var categoryId = $(this).val();
						if (categoryId) {
						  $.ajax({
							url: '{% url "get_subcategories" %}',
							data: {
							  'category_id': categoryId
							},
							success: function(data) {
							  var subcategorySelect = $('#subcategory');
							  subcategorySelect.empty();
							  subcategorySelect.append($('<option>', {
								value: '',
								text: 'Select a subcategory'
							  }));
							  $.each(data.subcategories, function(index, subcategory) {
								subcategorySelect.append($('<option>', {
								  value: subcategory.id,
								  text: subcategory.name
								}));
							  });
							}
						  });
						} else {
						  $('#subcategory').html('<option value="">Select a category first</option>');
						}
					  });
				  
					  $('#subcategory').on('change', function() {
						var subcategoryId = $(this).val();
						if (subcategoryId) {
						  $.ajax({
							url: '{% url "get_brands" %}',
							data: {
							  'subcategory_id': subcategoryId
							},
							success: function(data) {
							  var brandSelect = $('#brand');
							  brandSelect.empty();
							  brandSelect.append($('<option>', {
								value: '',
								text: 'Select a brand'
							  }));
							  $.each(data.brands, function(index, brand) {
								brandSelect.append($('<option>', {
								  value: brand.id,
								  text: brand.name
								}));
							  });
							}
						  });
						} else {
						  $('#brand').html('<option value="">Select a subcategory first</option>');
						}
					  });
				  
					  $('#brand').on('change', function() {
						var brandId = $(this).val();
						if (brandId) {
						  $.ajax({
							url: '{% url "get_type" %}',
							data: {
							  'brand_id': brandId
							},
							success: function(data) {
							  var typeSelect = $('#productType');
							  typeSelect.empty();
							  typeSelect.append($('<option>', {
								value: '',
								text: 'Select a type'
							  }));
							  $.each(data.types, function(index, type) {
								typeSelect.append($('<option>', {
								  value: type.id,
								  text: type.name
								}));
							  });
							}
						  });
						} else {
						  $('#productType').html('<option value="">Select a brand first</option>');
						}
					  });
				  
					  $('#productType').on('change', function() {
						var typeId = $(this).val();
						if (typeId) {
						  $.ajax({
							url: '{% url "get_subtype" %}',
							data: {
							  'type_id': typeId
							},
							success: function(data) {
							  var subtypeSelect = $('#subtype');
							  subtypeSelect.empty();
							  subtypeSelect.append($('<option>', {
								value: '',
								text: 'Select a subtype'
							  }));
							  $.each(data.subtypes, function(index, subtype) {
								subtypeSelect.append($('<option>', {
								  value: subtype.id,
								  text: subtype.name
								}));
							  });
							}
						  });
						} else {
						  $('#subtype').html('<option value="">Select a type first</option>');
						}
					  });
				  
					  // Prevent the dropdown from closing when a checkbox is clicked
					  $('#supplierDropdownMenu').on('click', function(e) {
						e.stopPropagation();
					  });
				  
					  // Toggle the dropdown menu when the button is clicked
					  $('#supplierDropdown button').on('click', function() {
						$('#supplierDropdownMenu').toggleClass('show');
					  });
				  
					  // Close the dropdown when the user clicks outside of it or focuses on another form field
					  $(document).on('click focusin', function(e) {
						if (!$('#supplierDropdown').is(e.target) && $('#supplierDropdown').has(e.target).length === 0) {
						  // Close the dropdown
						  $('#supplierDropdownMenu').removeClass('show');
						}
					  });
					});
				  </script>
				  





				<div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-xl" role="document">
					  <div class="modal-content">
						<div class="modal-header">
						  <h5 class="modal-title" id="productModalLabel">Product Details</h5>
						  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						  </button>
						</div>
						<div class="modal-body">
						  <ul class="nav nav-tabs" id="productTabs" role="tablist">
							<li class="nav-item">
							  <a class="nav-link active" id="product-details-tab" data-toggle="tab" href="#product-details" role="tab" aria-controls="product-details" aria-selected="true">Product Details</a>
							</li>
							<li class="nav-item">
							  <a class="nav-link supplier" id="supplier-details-tab" data-toggle="tab" href="#supplier-details" role="tab" aria-controls="supplier-details" aria-selected="false">Supplier Details</a>
							</li>
							<li class="nav-item">
								<a class="nav-link stocktab" id="stock-details-tab" data-toggle="tab" href="#stock-details" role="tab" aria-controls="stock-details" aria-selected="false">Stock Details</a>
							</li>
							<li class="nav-item">
								<a class="nav-link storagetab" id="storage-details-tab" data-toggle="tab" href="#storage-details" role="tab" aria-controls="storage-details" aria-selected="false">Storage Details</a>
							</li>
							<li class="nav-item">
								<a class="nav-link orderstab" id="orders-details-tab" data-toggle="tab" href="#orders-details" role="tab" aria-controls="orders-details" aria-selected="false">Orders Details</a>
							</li>
							<li class="nav-item ">
								<a class="nav-link salestab" id="sales-details-tab" data-toggle="tab" href="#sales-details" role="tab" aria-controls="sales-details" aria-selected="false">sales Details</a>
							</li>
							<!-- Add tabs for other sections here -->
						  </ul>
						  <div class="tab-content" id="productTabContent">
							<div class="tab-pane fade show active" id="product-details" role="tabpanel" aria-labelledby="product-details-tab">
							  <!-- Content for the Product Details tab goes here -->
							</div>
							<div class="tab-pane fade" id="supplier-details" role="tabpanel" aria-labelledby="supplier-details-tab">
							  <!-- Content for the Supplier Details tab goes here -->
							</div>
							<div class="tab-pane fade" id="stock-details" role="tabpanel" aria-labelledby="stock-details-tab">
								<!-- Content for the Supplier Details tab goes here -->
							  </div>
							  <div class="tab-pane fade" id="storage-details" role="tabpanel" aria-labelledby="storage-details-tab">
								<!-- Content for the Supplier Details tab goes here -->
							  </div>
							  <div class="tab-pane fade" id="orders-details" role="tabpanel" aria-labelledby="orders-details-tab">
								<!-- Content for the Supplier Details tab goes here -->
							  </div>
							  <div class="tab-pane fade" id="sales-details" role="tabpanel" aria-labelledby="sales-details-tab">
								<!-- Content for the Supplier Details tab goes here -->
							  </div>
							<!-- Add content for other tabs here -->
						  </div>
						</div>
					  </div>
					</div>
				  </div>
				</div>
				  


		    			
				<div class="tab-content" id="orders-table-tab-content">
					<div class="tab-pane fade show active" id="orders-all" role="tabpanel" aria-labelledby="orders-all-tab">
						<div class="app-card app-card-orders-table shadow-sm mb-5">
							<div class="app-card-body">
								<div class="table-responsive">
									<table class="table app-table-hover mb-0 text-left">
										<thead>
											<tr>
												<th class="cell"></th> <!-- Add an empty header cell for checkboxes -->
												<th class="cell">Product</th>
												<th class="cell">Category</th>
												<th class="cell">Subcategory</th>
												<th class="cell">Maximum Quantity</th>
												<th class="cell">Threshold Value</th>
												<th class="cell"></th>
												<th class="cell"></th>
											</tr>
										</thead>
										<tbody>
											{% for product in page %}
											{% if product.is_active %}
											<tr class="product-row">
												<td class="cell"> <!-- Add a checkbox in this cell -->
													<input type="checkbox" class="product-checkbox" data-product-id="{{ product.product_id }}">
													<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
												</td>
												<td class="cell product-name">
													<a class="product-details-link" href="#" data-toggle="modal" data-target="#productModal" data-product-id="{{ product.product_id }}" data-product-details="{{ product.brand }} {{ product.product_type }} {{ product.subtype }} {{ product.product_name }}">
													{{ product.brand }} {{ product.product_type }} {{ product.subtype }} {{ product.product_name }}
													</a>
												  </td>
												<td class="cell">{{ product.category }}</td>
												<td class="cell">{{ product.subcategory }}</td>
												<td class="cell">{{ product.quantity }}</td>
												<td class="cell">{{ product.threshold_value }}</td>
												<td class="cell">
													<a class="btn btn-danger text-white delete-product " href="#" data-product-id="{{ product.product_id }}">Delete</a>
												</td>
												<td class="cell">
													<a class="btn btn-primary text-white update-product" id="updatebutton" href="#" data-product-id="{{ product.product_id }}">Update</a>
												</td>
											</tr>
											{% endif %}
											{% endfor %}
										</tbody>
									</table>
								</div><!--//table-responsive-->
							</div><!--//app-card-body-->
						</div><!--//app-card-->
					</div>
				</div>
		
				<script>
					$(document).ready(function () {
						// Add an event listener to handle delete clicks
						const deleteLinks = document.querySelectorAll(".delete-product");
				
						deleteLinks.forEach(link => {
							link.addEventListener("click", function (e) {
								e.preventDefault();
								const productId = link.getAttribute("data-product-id");
				
								if (productId) {
									const confirmation = window.confirm("Are you sure you want to delete this product?");
				
									if (confirmation) {
										// Send an AJAX request to the Django view to delete the product
										$.ajax({
											url: `/delete-product/${productId}/`, // Replace with your delete view URL
											method: "POST", // or "GET" depending on your view
											data: {
												csrfmiddlewaretoken: '{{ csrf_token }}', // Include CSRF token
											},
											success: function (data) {
												// Handle success (e.g., remove the row from the table)
												link.closest("tr").remove();
												window.location.href = "/list_products/";
											},
											error: function (error) {
												console.error("Error deleting product:", error);
											},
										});
									}
								}
							});
						});
				

						let productId; // Declare a global variable to store the product ID

						$(document).ready(function () {
							$('.product-details-link').on('click', function () {
								productId = $(this).data('product-id'); // Store the product ID globally
								// Make an AJAX request to retrieve product details
								$.ajax({
									url: '/get_product_details/',  // Replace with the correct URL in your Django application
									method: 'GET',
									data: { product_id: productId },
									success: function (response) {
										if (response.error) {
											// Handle error if the product is not found
											$('#product-details').html(`<p>${response.error}</p>`);
										} else {
											// Build an HTML table to display all product details with formatting and styles
											let productDetailsHTML = '<table class="product-details-table">';
											for (const key in response) {
												let formattedValue = response[key];

												// Apply special formatting for specific fields
												if (key === 'product_image') {
													formattedValue = `<img src="${formattedValue}" alt="Product Image" style="max-width: 100px;" />`;
												} else if (key === 'is_active') {
													formattedValue = formattedValue ? 'Active' : 'Inactive';
												}

												productDetailsHTML += `<tr class="product-details-row"><td class="product-details-key">${key}</td> <td class="product-details-value">${formattedValue}</td></tr>`;
											}
											productDetailsHTML += '</table>';
											$('#product-details').html(productDetailsHTML);

											// Populate other tabs as needed

											// Select the Product Details tab by default
											$('#productTabs a[href="#product-details"]').tab('show');
										}
									},
									error: function () {
										// Handle error if the request fails
										console.error('Failed to retrieve product details.');
									}
								});
							});

							$('.supplier').on('click', function (e) {
								e.preventDefault();
								const tabId = $(this).attr('href');
								if (tabId === '#supplier-details') {
									// Clear existing content
									$('#supplier-details').empty();
							
									// Make an AJAX request to retrieve supplier details
									$.ajax({
										url: '/get_supplier_details/',
										method: 'GET',
										data: { product_id: productId },
										success: function (response) {
											if (response.error) {
												// Handle error if the product is not found
												$('#supplier-details').html(`<p>${response.error}</p>`);
											} else if (Array.isArray(response) && response.length > 0) {
												// Create a styled table
												let supplierDetailsHTML = `
													<table class="table table-striped">
														<thead>
															<tr>
																<th>Name</th>
																<th>Contact</th>
																<th>Image</th>
																<!-- Add more table headers for additional fields -->
															</tr>
														</thead>
														<tbody>
												`;
							
												response.forEach(function (supplier) {
													// Format and append each row of data
													supplierDetailsHTML += `
														<tr>
															<td>${supplier.name}</td>
															<td>${supplier.contact}</td>
															<td><img src="${supplier.image}" alt="Supplier Image" style="max-width: 100px;"></td>
															<!-- Add more cells for additional fields -->
														</tr>
													`;
												});
							
												supplierDetailsHTML += `
														</tbody>
													</table>
												`;
							
												$('#supplier-details').html(supplierDetailsHTML);
							
												// Activate the Supplier Details tab
												$('#productTabs a[href="#supplier-details"]').tab('show');
											} else {
												// Handle case when no suppliers are associated
												$('#supplier-details').html(`<p>No suppliers found for this product.</p>`);
											}
										},
										error: function () {
											console.error('Failed to retrieve supplier details.');
										}
									});
								}
							});



							$('.stocktab').on('click', function (e) {
								e.preventDefault();
								const tabId = $(this).attr('href');
								console.log(tabId);
								if (tabId === '#stock-details') {
									// Clear existing content
									$('#stock-details').empty();
							
									// Make an AJAX request to retrieve stock details
									$.ajax({
										url: '/get_stock_details/',
										method: 'GET',
										data: { product_id: productId },
										success: function (response) {
											if (response.error) {
												// Handle error if stock is not found
												$('#stock-details').html(`<p>${response.error}</p>`);
											} else if (Array.isArray(response) && response.length > 0) {
												// Create a styled table to display stock details
												let stockDetailsHTML = `
													<table class="table table-striped">
														<thead>
															<tr>
																<th>Sector</th>
																<th>Row Start</th>
																<th>Column Start</th>
																<th>Column End</th>
																<th>Remaining Quantity</th>
																<th>Is Stored</th>
															</tr>
														</thead>
														<tbody>
												`;
							
												response.forEach(function (stock) {
													// Format and append each row of data
													stockDetailsHTML += `
														<tr>
															<td>${stock.sector}</td>
															<td>${stock.row_start}</td>
															<td>${stock.column_start}</td>
															<td>${stock.column_end}</td>
															<td>${stock.remaining_quantity}</td>
															<td>${stock.is_stored}</td>
														</tr>
													`;
												});
							
												stockDetailsHTML += `
														</tbody>
													</table>
												`;
							
												$('#stock-details').html(stockDetailsHTML);
							
												// Activate the Stock Details tab
												$('#productTabs a[href="#stock-details"]').tab('show');
											} else {
												// Handle case when no stock is associated
												$('#stock-details').html(`<p>No stock found for this order.</p>`);
											}
										},
										error: function () {
											console.error('Failed to retrieve stock details.');
										}
									});
								}
							});
							




							// Attach a click event handler to the "Storage" tab
							$('.storagetab').on('click', function (e) {
								e.preventDefault();
								const tabId = $(this).attr('href');
								console.log(productId);
								if (tabId === '#storage-details') {
									// Clear existing content
									$('#storage-details').empty();

									// You can replace this with your actual URL and product ID
									
									// Make an AJAX request to retrieve product location details
									$.ajax({
										url: '/get_product_location_details/', // Replace with your URL
										method: 'GET',
										data: { product_id: productId },
										success: function (response) {
											if (response.error) {
												// Handle error if product location is not found
												$('#storage-details').html(`<p>${response.error}</p>`);
											} else {
												// Create a styled table to display product location details
												let locationDetailsHTML = `
													<table class="table table-striped">
														<thead>
															<tr>
																<th>Storage Location</th>
																<th>Shelf Number</th>
																<th>Row Number</th>
																<th>Column Number</th>
															</tr>
														</thead>
														<tbody>
												`;

												// Loop through the response data (replace with your actual data structure)
												response.forEach(function (location) {
													// Format and append each row of data
													locationDetailsHTML += `
														<tr>
															<td>${location.storage_location}</td>
															<td>${location.shelf_number}</td>
															<td>${location.row_number}</td>
															<td>${location.column_number}</td>
														</tr>
													`;
												});

												locationDetailsHTML += `
														</tbody>
													</table>
												`;

												$('#storage-details').html(locationDetailsHTML);

												// Activate the Storage Details tab
												$('#productTabs a[href="#storage-details"]').tab('show');
											}
										},
										error: function () {
											console.error('Failed to retrieve product location details.');
										}
									});
								}
							});

							


							$('.orderstab').on('click', function (e) {
								e.preventDefault();
								const tabId = $(this).attr('href');
								if (tabId === '#orders-details') {
									// Clear existing content
									$('#orders-details').empty();
							
									// Make an AJAX request to retrieve order details
									$.ajax({
										url: '/get_order_details/',
										method: 'GET',
										data: { product_id: productId },
										success: function (response) {
											if (response.error) {
												// Handle error if no orders are found
												$('#orders-details').html(`<p>${response.error}</p>`);
											} else {
												// Create and populate a table with order details
												let ordersDetailsHTML = `
													<table class="table table-striped">
														<thead>
															<tr>
																<th>Order ID</th>
																<th>Status</th>
																<th>Warehouse</th>
																<th>Quantity</th>
																<th>Buying Price</th>
																<th>Total Price</th>
																<th>Is Stored</th>
																<th>Delivered At</th>
															</tr>
														</thead>
														<tbody>
												`;
							
												response.forEach(function (order) {
													// Format and append each row of data
													ordersDetailsHTML += `
														<tr>
															<td>${order.order_id}</td>
															<td>${order.order_status}</td>
															<td>${order.warehouse}</td>
															<td>${order.quantity}</td>
															<td>${order.buying_price}</td>
															<td>${order.total_price}</td>
															<td>${order.is_stored}</td>
															<td>${order.delivered_at}</td>
														</tr>
													`;
												});
							
												ordersDetailsHTML += `
														</tbody>
													</table>
												`;
							
												$('#orders-details').html(ordersDetailsHTML);
							
												// Activate the Orders Details tab
												$('#productTabs a[href="#orders-details"]').tab('show');
											}
										},
										error: function () {
											console.error('Failed to retrieve order details.');
										}
									});
								}
							});



							$('.salestab').on('click', function (e) {
								e.preventDefault();
								console.log("clickd");
								const tabId = $(this).attr('href');
								console.log(tabId);
								if (tabId === '#sales-details') {
									// Clear existing content
									$('#sales-details').empty();
							
									// Make an AJAX request to retrieve sales details
									$.ajax({
										url: '/get_sales_details/',
										method: 'GET',
										data: { product_id: productId },
										success: function (response) {
											if (response.error) {
												// Handle error if no sales are found
												$('#sales-details').html(`<p>${response.error}</p>`);
											} else {
												// Create and populate a table with sales details
												let salesDetailsHTML = `
													<table class="table table-striped">
														<thead>
															<tr>
																<th>Sale ID</th>
																<th>Date</th>
																<th>Quantity</th>
																<th>Delivery Address</th>
																<th>Sales Price</th>
																<th>Status</th>
																<th>Buyer Name</th>
																<th>Buyer Contact Info</th>
																<th>Total Sales Price</th>
																<th>Total Buying Price</th>
																<th>Profit</th>
															</tr>
														</thead>
														<tbody>
												`;
							
												response.forEach(function (sale) {
													// Format and append each row of data
													salesDetailsHTML += `
														<tr>
															<td>${sale.sale_id}</td>
															<td>${sale.date}</td>
															<td>${sale.quantity}</td>
															<td>${sale.delivery_address}</td>
															<td>${sale.sales_price}</td>
															<td>${sale.status}</td>
															<td>${sale.buyer_name}</td>
															<td>${sale.buyer_contact_info}</td>
															<td>${sale.total_sales_price}</td>
															<td>${sale.total_buying_price}</td>
															<td>${sale.profit}</td>
														</tr>
													`;
												});
							
												salesDetailsHTML += `
														</tbody>
													</table>
												`;
							
												$('#sales-details').html(salesDetailsHTML);
							
												// Activate the Sales Details tab
												$('#productTabs a[href="#sales-details"]').tab('show');
											}
										},
										error: function () {
											console.error('Failed to retrieve sales details.');
										}
									});
								}
							});
							
							
						});

						




						// Add event listeners for checkboxes
						const checkboxes = document.querySelectorAll(".product-checkbox");
				
						checkboxes.forEach(checkbox => {
							checkbox.addEventListener("change", function () {
								// Check if at least one checkbox is checked
								const isChecked = Array.from(checkboxes).some(cb => cb.checked);
								const deleteAllButton = document.getElementById("deleteAllButton");
				
								// Enable or disable the "Delete All" button based on checkbox state
								deleteAllButton.disabled = !isChecked;
							});
						});
				
						// Add an event listener for the "Delete All" button
						const csrfToken = "{{ csrf_token }}";
						const deleteAllButton = document.getElementById("deleteAllButton");
				
						deleteAllButton.addEventListener("click", function () {
							const checkedCheckboxes = document.querySelectorAll(".product-checkbox:checked");
				
							// Show a confirmation dialog
							const confirmation = window.confirm("Are you sure you want to delete the selected products?");
				
							if (confirmation) {
								// Get the product IDs of selected checkboxes
								const productIds = Array.from(checkedCheckboxes).map(cb => cb.getAttribute("data-product-id"));
				
								// Create a FormData object to send the data including the CSRF token
								const formData = new FormData();
								productIds.forEach(productId => {
									formData.append("product_ids[]", productId);
								});
				
								formData.append("csrfmiddlewaretoken", csrfToken);
				
								// Send an AJAX request to delete multiple products
								$.ajax({
									url: `/delete-multiple-products/`, // Replace with your delete multiple products view URL
									method: "POST", // or "GET" depending on your view
									data: formData, // Send the FormData object
									processData: false, // Prevent jQuery from processing the data
									contentType: false, // Set content type to false to prevent jQuery from adding a content type header
									success: function (data) {
										// Handle success (e.g., remove the rows from the table)
										productIds.forEach(productId => {
											const rowToRemove = document.querySelector(`.product-row[data-product-id="${productId}"]`);
											if (rowToRemove) {
												rowToRemove.remove();
											}
										});
				
										// Disable the "Delete All" button after deletion
										deleteAllButton.disabled = true;
				
										// Redirect to the product list page
										window.location.href = "/list_products/";
									},
									error: function (error) {
										console.error("Error deleting products:", error);
									},
								});
							}
						});
				



						
						function fetchProductData(productId) {
							$.ajax({
								url: `/get-product-details/${productId}/`,
								method: "GET",
								dataType: "json", // Specify the expected data type as JSON
								success: function (productData) {
									// Populate the form fields with the retrieved data
									document.getElementById("category").value = productData.category_id;
									document.getElementById("subcategory").value = productData.subcategory_id;
									document.getElementById("productName").value = productData.product_name;
									document.getElementById("quantity").value = productData.quantity;
									document.getElementById("thresholdValue").value = productData.threshold_value;
				
									var previewImage = document.getElementById("previewImage");
									previewImage.src = productData.product_image_url;
									previewImage.style.display = "block"; // Show the image
				
									// Optionally, you can add logging to verify the data
									console.log("Product Data:", productData);
								},
								error: function () {
									// Handle error if the AJAX request fails
									console.error("Failed to fetch product data.");
								},
							});
						}
				
						// Add an event listener for the update form
						const updateButtons = document.querySelectorAll('.update-product');
						const productFormPopup = document.getElementById('productFormPopup');
						const cancelButton = document.getElementById('cancelButton');
				
						updateButtons.forEach(button => {
							button.addEventListener('click', () => {
								productFormPopup.style.display = 'block';
								const productId = button.getAttribute('data-product-id');
								document.getElementById('product-id').value = productId;
								fetchProductData(productId);
							});
						});
				
						cancelButton.addEventListener('click', () => {
							productFormPopup.style.display = 'none';
							window.location.href = "/list_products/"; 
						});
				
						$('#category').on('change', function () {
							var categoryId = $(this).val();
							if (categoryId) {
								$.ajax({
									url: '{% url "get_subcategories" %}', // Use the URL pattern name
									data: {
										'category_id': categoryId
									},
									success: function (data) {
										var subcategorySelect = $('#subcategory');
										subcategorySelect.empty(); // Clear previous options
										subcategorySelect.append($('<option>', {
											value: '',
											text: 'Select a subcategory'
										}));
										$.each(data.subcategories, function (index, subcategory) {
											subcategorySelect.append($('<option>', {
												value: subcategory.id,
												text: subcategory.name
											}));9
										});
									}
								});
							} else {
								$('#subcategory').html('<option value="">Select a category first</option>');
							}
						});
				
						$('#search-orders').on('input', function () {
							var searchText = $(this).val().toLowerCase();
							searchProducts(searchText);
						});
				
						// Function to search for products based on the product name
						function searchProducts(searchText) {
							// Iterate through each product row
							$('.product-row').each(function () {
								var productName = $(this).find('.product-name').text().toLowerCase();
								var row = $(this);
				
								// Check if the product name contains the search text
								if (productName.includes(searchText)) {
									row.show(); // Show the row if it matches
								} else {
									row.hide(); // Hide the row if it doesn't match
								}
							});
						}
				
						const updateProductForm = document.getElementById("add-product-form");

						updateProductForm.addEventListener("submit", function (e) {
							e.preventDefault();

							// Collect the updated data from the form
							const formData = new FormData(updateProductForm);

							// Extract the product_id from the form or data attributes
							const productId = document.getElementById("product-id").value;

							// Define the base URL for the AJAX request
							let baseUrl =  `/add_product/`;

							if (productId) {
								// If productId is not null, append it to the base URL
								baseUrl =  `/update-product/${productId}/`;
							}

							// Send an AJAX request to the dynamically determined URL
							$.ajax({
								url: baseUrl,
								method: "POST",
								data: formData,
								processData: false,
								contentType: false,
								success: function (data) {
									// Handle success (e.g., show a success message)
									console.log(data.message);
										// Redirect to the "add_product" URL if productId is null
										window.location.href = "/list_products/"; // Replace with the correct URL
								},
								error: function (error) {
									// Handle errors (e.g., display an error message)
									console.error("Error updating product:", error);
								},
							});
						});

						function updateImagePreview(input, previewId) {
							var preview = document.getElementById(previewId);
							var imagePreview = document.getElementById(previewId + "Preview");
				
							if (input.files && input.files[0]) {
								var reader = new FileReader();
				
								reader.onload = function (e) {
									preview.src = e.target.result;
									imagePreview.style.display = 'block'; // Show the preview container
								};
				
								reader.readAsDataURL(input.files[0]);
							} else {
								preview.src = '';
								imagePreview.style.display = 'none'; // Hide the preview container
							}
						}
				
						// Add an event listener to the file input field for the "Add Product" form
						var productImageInput = document.getElementById('productImage');
						productImageInput.addEventListener('change', function () {
							updateImagePreview(this, 'previewImage');
						});
				
						// Add an event listener to the file input field for the "Update Product" form
				
						const productName = document.querySelector("#productName");
						const quantity = document.querySelector("#quantity");
						const thresholdValue = document.querySelector("#thresholdValue");
						const category = document.querySelector("#category");
						const subcategory = document.querySelector("#subcategory");
				
						const productNameError = document.querySelector("#productNameError");
						const quantityError = document.querySelector("#quantityError");
						const thresholdValueError = document.querySelector("#thresholdValueError");
						const categoryError = document.querySelector("#categoryError");
						const subcategoryError = document.querySelector("#subcategoryError");
				
						// Regular expressions for validation
						const nameRegex = /^[a-zA-Z0-9\s]+$/;

						const numberRegex = /^[0-9]+$/;
				
						productName.addEventListener("input", function () {
							if (!nameRegex.test(productName.value)) {
								productNameError.textContent = "Please enter a valid product name (letters, numbers and spaces only).";
							} else {
								productNameError.textContent = "";
							}
						});
				
						quantity.addEventListener("input", function () {
							if (!numberRegex.test(quantity.value)) {
								quantityError.textContent = "Quantity must be numeric.";
							} else {
								quantityError.textContent = "";
							}
						});
				
						thresholdValue.addEventListener("input", function () {
							if (!numberRegex.test(thresholdValue.value)) {
								thresholdValueError.textContent = "Threshold Value must be numeric.";
							} else {
								thresholdValueError.textContent = "";
							}
						});
				
						category.addEventListener("input", function () {
							if (category.value === "") {
								categoryError.textContent = "Please select a category.";
							} else {
								categoryError.textContent = "";
							}
						});
				
						subcategory.addEventListener("input", function () {
							if (subcategory.value === "") {
								subcategoryError.textContent = "Please select a subcategory.";
							} else {
								subcategoryError.textContent = "";
							}
						});
				
						const form = document.querySelector("form");
						form.addEventListener("submit", function (event) {
							if (
								!nameRegex.test(productName.value) ||
								!numberRegex.test(quantity.value) ||
								!numberRegex.test(thresholdValue.value) ||
								category.value === "" ||
								subcategory.value === ""
							) {
								event.preventDefault();
							}
						});
				
						function validateImageFormat(input) {
							const productImageError = document.querySelector("#productImageError");
							const imageExtensions = ["jpg", "jpeg", "png", "gif"];
							const selectedFile = input.files[0];
				
							if (selectedFile) {
								const imageExtension = selectedFile.name.split(".").pop().toLowerCase();
								if (!imageExtensions.includes(imageExtension)) {
									productImageError.textContent = "Invalid image format. Supported formats: JPG, JPEG, PNG, GIF";
									input.value = ""; // Clear the file input
								} else {
									productImageError.textContent = "";
								}
							}
						}
				
						// Event listener for the product image input
						const productImage = document.querySelector("#productImage");
						productImage.addEventListener("input", function () {
							validateImageFormat(this);
						});




						
					});
				</script>
				
						
<nav class="app-pagination">
    <ul class="pagination justify-content-center">
        {% if page.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1">&laquo; first</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page.previous_page_number }}">previous</a>
            </li>
        {% else %}
            <li class="page-item disabled">
                <span class="page-link">&laquo; first</span>
            </li>
            <li class="page-item disabled">
                <span class="page-link">previous</span>
            </li>
        {% endif %}
        <li class="page-item active">
            <span class="page-link">{{ page.number }}</span>
        </li>
        {% if page.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page.next_page_number }}">next</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page.paginator.num_pages }}">last &raquo;</a>
            </li>
        {% else %}
            <li class="page-item disabled">
                <span class="page-link">next</span>
            </li>
            <li class="page-item disabled">
                <span class="page-link">last &raquo;</span>
            </li>
        {% endif %}
    </ul>
</nav><!--//app-pagination-->

						
			        </div><!--//tab-pane-->
				</div><!--//tab-content-->		    
		    </div><!--//container-fluid-->
	    </div><!--//app-content-->
	    
    
    </div><!--//app-wrapper-->    					

 
    <!-- Javascript -->          
    <script src="{% static 'assets/plugins/popper.min.js' %}"></script>
    <script src="{% static 'assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>  
	
    
    <!-- Page Specific JS -->
    <script src="{% static 'assets/js/app.js' %}"></script> 
	
</body>
</html> 