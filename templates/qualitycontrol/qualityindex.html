{% load static %}
<!DOCTYPE html>
<html lang="en" class="fontawesome-i2svg-active fontawesome-i2svg-complete">
	<head>
		<title>WAREFLOW</title>

		<!-- Meta -->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- FontAwesome JS-->
		<script defer src="{% static 'assets/plugins/fontawesome/js/all.min.js' %}"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

		<!-- App CSS -->
		<link id="theme-style" rel="stylesheet"
			href="{% static 'assets/css/portal.css' %}">

		<style>
				/* Style for the select element */
				#month-select {
					padding: 5px;
					font-size: 16px;
					border: 1px solid #ccc;
					border-radius: 5px;
					width: 200px; /* Adjust the width as needed */
				}
		
				/* Style for the options within the select element */
				#month-select option {
					font-size: 14px;
				}


			</style>
	</head>

	<body class="app">
		<header class="app-header fixed-top">
			<div class="app-header-inner">
				<div class="container-fluid py-2">
					<div class="app-header-content">
						<div class="row justify-content-between align-items-center">

							<div class="col-auto">
								<a id="sidepanel-toggler"
									class="sidepanel-toggler d-inline-block d-xl-none" href="#">
									<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30"
										viewBox="0 0 30 30" role="img"><title>Menu</title><path
											stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10"
											stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg>
								</a>
							</div><!--//col-->

							<div class="app-utilities col-auto ml-auto">
    							<div class="app-utility-item app-user-dropdown dropdown">
									<a class="dropdown-toggle" id="user-dropdown-toggle"
										data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
										<img
											src="{% if request.session.profile_picture_url %}{{ request.session.profile_picture_url }}{% else %}{% static 'assets/images/user.png' %}{% endif %}"
											alt="user profile">
									</a>
									<ul class="dropdown-menu" aria-labelledby="user-dropdown-toggle">
										<li><span class="dropdown-item">{{ request.session.name }}</span></li>
										<li><a class="dropdown-item" href={% url 'quality_profile' %}>Account</a></li>
										<li><hr class="dropdown-divider"></li>
										<li><a class="dropdown-item" href={% url 'loggout' %}>Log Out</a></li>
									</ul>
								</div><!--//app-user-dropdown-->
							</div><!--//app-utilities-->
						</div><!--//row-->
					</div><!--//app-header-content-->
				</div><!--//container-fluid-->
			</div><!--//app-header-inner-->
			<div id="app-sidepanel" class="app-sidepanel">
				<div id="sidepanel-drop" class="sidepanel-drop"></div>
				<div class="sidepanel-inner d-flex flex-column">
					<a href="#" id="sidepanel-close" class="sidepanel-close d-xl-none">&times;</a>
					<div class="app-branding">
						<a class="app-logo" href="{% url 'qualityindex' %}"><img class="logo-icon me-2"
								src="{% static 'assets/images/app-logo.svg' %}" alt="logo"><span
								class="logo-text">WAREFLOW</span></a>

					</div><!--//app-branding-->

					<nav id="app-nav-main" class="app-nav app-nav-main flex-grow-1">
						<ul class="app-menu list-unstyled accordion" id="menu-accordion">
							<li class="nav-item">
								<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
								<a class="nav-link active" href="{% url 'qualityindex' %}">
									<span class="nav-icon">
										<svg width="1em" height="1em" viewBox="0 0 16 16"
											class="bi bi-house-door" fill="currentColor"
											xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd"
												d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z" />
											<path fill-rule="evenodd"
												d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
										</svg>
									</span>
									<span class="nav-link-text">Dashboard</span>
								</a><!--//nav-link-->
							</li><!--//nav-item-->
							<li class="nav-item">
								<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
								<a class="nav-link" href="{% url 'order_list' %}">
									<span class="nav-icon svg-icon svg-icon-primary svg-icon-2x"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-05-14-112058/theme/html/demo8/dist/../src/media/svg/icons/Shopping/Cart1.svg--><svg
											xmlns="http://www.w3.org/2000/svg"
											xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px"
											viewBox="0 0 24 24" version="1.1">
											<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
												<rect x="0" y="0" width="24" height="24" />
												<path
													d="M18.1446364,11.84388 L17.4471627,16.0287218 C17.4463569,16.0335568 17.4455155,16.0383857 17.4446387,16.0432083 C17.345843,16.5865846 16.8252597,16.9469884 16.2818833,16.8481927 L4.91303792,14.7811299 C4.53842737,14.7130189 4.23500006,14.4380834 4.13039941,14.0719812 L2.30560137,7.68518803 C2.28007524,7.59584656 2.26712532,7.50338343 2.26712532,7.4104669 C2.26712532,6.85818215 2.71484057,6.4104669 3.26712532,6.4104669 L16.9929851,6.4104669 L17.606173,3.78251876 C17.7307772,3.24850086 18.2068633,2.87071314 18.7552257,2.87071314 L20.8200821,2.87071314 C21.4717328,2.87071314 22,3.39898039 22,4.05063106 C22,4.70228173 21.4717328,5.23054898 20.8200821,5.23054898 L19.6915238,5.23054898 L18.1446364,11.84388 Z"
													fill="#000000" opacity="0.3" />
												<path
													d="M6.5,21 C5.67157288,21 5,20.3284271 5,19.5 C5,18.6715729 5.67157288,18 6.5,18 C7.32842712,18 8,18.6715729 8,19.5 C8,20.3284271 7.32842712,21 6.5,21 Z M15.5,21 C14.6715729,21 14,20.3284271 14,19.5 C14,18.6715729 14.6715729,18 15.5,18 C16.3284271,18 17,18.6715729 17,19.5 C17,20.3284271 16.3284271,21 15.5,21 Z"
													fill="#000000" />
											</g>
										</svg><!--end::Svg Icon--></span>
									<span class="nav-link-text">Pending Orders</span>
								</a><!--//nav-link-->
							</li><!--//nav-item-->
							<li class="nav-item">
								<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
								<a class="nav-link" href="{% url 'inspection_list' %}">
									<span class="nav-icon">
										<svg width="1em" height="1em" viewBox="0 0 16 16"
											class="bi bi-house-door" fill="currentColor"
											xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd"
												d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z" />
											<path fill-rule="evenodd"
												d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
										</svg>
									</span>
									<span class="nav-link-text">inspections done</span>
								</a><!--//nav-link-->
							</li><!--//nav-item-->
							<!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
						</ul><!--//app-menu-->
					</nav><!--//app-nav-->
					<div class="app-sidepanel-footer">
						<nav class="app-nav app-nav-footer">
							<ul class="app-menu footer-menu list-unstyled">
								<li class="nav-item">
									<a class="nav-link" href={% url 'loggout' %}>
										<span class="nav-icon">
											<svg style="color: rgb(93, 94, 101);"
												xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none" stroke="currentColor"
												stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
												class="feather feather-log-out"><path
													d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" fill="#5d5e65"></path><polyline
													points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9"
													y2="12"></line></svg> </span>
										<span class="nav-link-text">Logout</span>
									</a>
								</li><!--//nav-item-->
							</ul><!--//footer-menu-->
						</nav>
					</div><!--//app-sidepanel-footer-->

				</div><!--//sidepanel-inner-->
			</div><!--//app-sidepanel-->
		</header><!--//app-header-->

		<div class="app-wrapper">
			<div class="app-content pt-3 p-md-3 p-lg-4">
				<div class="container-xl" id="sales-data-container">
					<h1 class="app-page-title">Quality Controller Dashboard</h1>

					<select id="month-select" class="form-select form-select-sm ms-auto mb-3">
						<option value>Select Month</option>
						{% for month in unique_months %}
						<option value="{{ month }}">{{ month }}</option>
						{% endfor %}
					</select>
					<div class="app-card alert alert-dismissible shadow-sm mb-4 border-left-decoration" role="alert">
						<h4>Inspection Overview</h4>
						<div class="inner">
							<div id="sales-data-container">
								<div class="row g-4 mb-4">
									<div class="col-12 col-md-6 col-lg-4"> <!-- Adjusted col-lg-3 to col-lg-4 -->
										<div class="app-card app-card-stat shadow-sm h-100">
											<div class="app-card-body p-3 p-lg-4">
												<h4 class="stats-type mb-2">Total Inspections pending</h4>
												<div class="stats-figure total-sales">{{ active_orders }}</div>
											</div><!--//app-card-body-->
										</div><!--//app-card-->
									</div><!--//col-->
					
									<div class="col-12 col-md-6 col-lg-4"> <!-- Adjusted col-lg-3 to col-lg-4 -->
										<div class="app-card app-card-stat shadow-sm h-100">
											<div class="app-card-body p-3 p-lg-4">
												<h4 class="stats-type mb-1">Passed Inspections</h4>
												<div class="stats-figure total-buying">{{ passed_inspections_count }}</div>
											</div><!--//app-card-body-->
										</div><!--//app-card-->
									</div><!--//col-->
					
									<div class="col-12 col-md-6 col-lg-4"> <!-- Adjusted col-lg-3 to col-lg-4 -->
										<div class="app-card app-card-stat shadow-sm h-100">
											<div class="app-card-body p-3 p-lg-4">
												<h4 class="stats-type mb-1">Failed Inspections</h4>
												<div class="stats-figure total-profit">{{ failed_inspections_count }}</div>
											</div><!--//app-card-body-->
										</div><!--//app-card-->
									</div><!--//col-->
								</div><!--//row-->
							</div><!--//sales-data-container-->
						</div><!--//inner-->
					</div><!--//app-card-->
					
				</div><!--//container-xl-->
			</div><!--//app-content-->

			<script>
				$(document).ready(function () {
					$('#month-select').change(function () {
						var selectedMonth = $(this).val();  // Get the selected month
						if (selectedMonth) {
							$.ajax({
								url: '{% url "get_inspection_data" %}',  // Replace with the actual URL
								type: 'GET',
								data: { selected_month: selectedMonth },
								dataType: 'json',
								success: function (data) {
									// Update the counts in the UI
									$('.total-buying').text(data.passed_count);
									$('.total-profit').text(data.failed_count);
								},
								error: function (xhr, status, error) {
									console.error(xhr.responseText);
								}
							});
						}
					});
				});
			</script>

			<script src="{% static 'assets/plugins/popper.min.js' %}"></script>
			<script src="{% static 'assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>

		</body>
	</html>
